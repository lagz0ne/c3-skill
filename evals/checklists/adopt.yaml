name: adopt
description: Structural requirements for C3 adoption

checks:
  # === Directory structure ===
  # Note: checks run against c3-output/ which IS the .c3/ snapshot
  - id: context-exists
    description: Created context document
    type: path_exists
    path: README.md

  - id: adr-dir-exists
    description: Created ADR directory
    type: path_exists
    path: adr/

  # === Context (c3-0) requirements ===
  - id: context-frontmatter
    description: Context has required YAML frontmatter
    type: frontmatter
    path: README.md
    required_fields:
      - id
      - c3-version
      - title
      - summary
    expect:
      id: c3-0
      c3-version: 3

  - id: context-sections
    description: Context has required sections
    type: sections
    path: README.md
    required:
      - "## Overview"
      - "## Containers"
      - "## Interactions"
      - "## External Actors"

  - id: context-mermaid
    description: Interactions uses Mermaid (not ASCII)
    type: contains
    path: README.md
    pattern: "```mermaid"

  - id: containers-table
    description: Containers section has ID|Name|Responsibility table
    type: regex
    path: README.md
    pattern: '^\|.*ID.*\|.*Name.*\|.*Responsibility.*\|'

  # === Container requirements ===
  - id: container-exists
    description: At least one container created
    type: glob_exists
    pattern: "c3-[0-9]-*/README.md"

  - id: container-frontmatter
    description: Container has required frontmatter
    type: frontmatter_glob
    pattern: "c3-[0-9]-*/README.md"
    required_fields:
      - id
      - c3-version
      - title
      - type
      - parent
      - summary
    expect:
      type: container
      c3-version: 3

  - id: container-inventory
    description: Container has 5-column component inventory (ID|Name|Type|Responsibility|Status)
    type: regex_glob
    pattern: "c3-[0-9]-*/README.md"
    regex: '^\|.*ID.*\|.*Name.*\|.*Type.*\|.*Responsibility.*\|.*Status.*\|'

  - id: container-tech-stack
    description: Container has Technology Stack section
    type: section_glob
    pattern: "c3-[0-9]-*/README.md"
    section: "## Technology Stack"

  - id: container-internal-structure
    description: Container has Internal Structure section with Mermaid
    type: section_glob
    pattern: "c3-[0-9]-*/README.md"
    section: "## Internal Structure"

  # === Anti-patterns (must NOT exist) ===
  - id: no-component-files
    description: No premature component doc files (inventory-first model)
    type: glob_not_exists
    pattern: "**/c3-[0-9][0-9][0-9]-*.md"
